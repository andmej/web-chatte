$(function() {  
  $("form").bind("ajax:before", function() {
    $(".loading").slideDown();
  });
  $("form").bind("ajax:complete", function() {
    $(".loading").slideUp();
  });
  
  if ($("#messages").size() > 0) {
    setInterval('$.getScript($("#messages").attr("data-url"));', 1000 * 5); // Periodically poll for changes
  }
});